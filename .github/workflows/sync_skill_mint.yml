name: Sync SKILL.md & REFERENCE.md from Mintlify

on:
  schedule:
    - cron: '0 */6 * * *' # Runs every 6 hours
  workflow_dispatch:      # Allows manual trigger

env:
  DOCS_BASE_URL: https://agentskills.io/

jobs:
  update-docs:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Fetch Remote Files
        run: |
          # Ensure target directories exist
          mkdir -p modellix
          mkdir -p references
          
          # Sync SKILL.md
          curl -L -s -o "SKILL.md" "${{ env.DOCS_BASE_URL }}/skill.md"
          
          # Sync REFERENCE.md
          curl -L -s -o "references/REFERENCE.md" "${{ env.DOCS_BASE_URL }}/llms.txt"

      - name: Commit and Push if Changed
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
          # Add both potential changes
          git add SKILL.md references/REFERENCE.md
          
          # Check if there are any staged changes
          if [[ -n "$(git status --porcelain)" ]]; then
            git commit -m "chore: sync docs from remote source"
            git push
          else
            echo "No changes detected in either file, skipping commit."
          fi
